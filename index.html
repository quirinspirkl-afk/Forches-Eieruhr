<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eieruhr</title>

<!-- PWA -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Eieruhr">
<meta name="theme-color" content="#1794e2">
<link rel="manifest" href="manifest.json">

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<style>
:root {
    --bg-image: url("img/flag-bosnia.jpg");
}

body {
    margin: 0;
    min-height: 100vh;
    background-image: var(--bg-image);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    font-family: "Roboto", sans-serif;
    color: white;
}

/* MenÃ¼ */
.menu {
    position: absolute;
    top: 16px;
    left: 16px;
    z-index: 10;
}

.menu button {
    padding: 8px 14px;
    font-size: 16px;
    border-radius: 20px;
}

/* MenÃ¼ Panel */
.menu-panel {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    padding: 20px;
    display: none;
    flex-direction: column;
    gap: 14px;
    z-index: 20;
}

.menu-panel button,
.menu-panel select {
    padding: 10px;
    font-size: 16px;
}

/* Bild */
img {
    position: absolute;
    top: 90px;
    left: 50%;
    transform: translateX(-50%);
    width: 140px;
    height: 140px;
    object-fit: cover;
    border-radius: 50%;
    border: 3px solid rgba(255,255,255,0.6);
    z-index: 5;
}

/* Inhalt */
.container {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    gap: 55px;
    padding-top: 380px;
}

.timer {
    font-size: 64px;
    font-weight: 700;
    text-shadow: 0 4px 10px rgba(0,0,0,0.4);
}

.adjust,
.controls {
    display: flex;
    gap: 12px;
}

.adjust button {
    width: 60px;
    font-size: 22px;
}

.controls button {
    width: 120px;
    font-size: 18px;
    padding: 14px;
}
</style>
</head>

<body>

<!-- Dynamischer Sound -->
<audio id="alarmSound" preload="auto" loop></audio>

<div class="menu">
    <button onclick="toggleMenu()">â˜° MenÃ¼</button>
</div>

<div class="menu-panel" id="menuPanel">
    <strong>Garzeiten</strong>
    <button onclick="setPreset(300)">ğŸ¥š Weich (5:00)</button>
    <button onclick="setPreset(420)">ğŸ¥š Wachsweich (7:00)</button>
    <button onclick="setPreset(600)">ğŸ¥š Hart (10:00)</button>

    <hr>

    <strong>Design</strong>
    <select onchange="changeBackground(this.value)">
        <option value="bosnia">ğŸ‡§ğŸ‡¦ Bosnien</option>
        <option value="albania">ğŸ‡¦ğŸ‡± Albanien</option>
        <option value="croatia">ğŸ‡­ğŸ‡· Kroatien</option>
        <option value="turkey">ğŸ‡¹ğŸ‡· TÃ¼rkei</option>
    </select>

    <hr>

    <strong>Sound</strong>
    <select onchange="setSound(this.value)">
        <option value="normal">ğŸ”Š Sound</option>
        <option value="off">ğŸ”• Aus</option>
    </select>

    <button onclick="toggleMenu()">SchlieÃŸen</button>
</div>

<img src="img/egg.png" alt="Ei">

<div class="container">
    <div class="timer" id="timer">07:00</div>

    <div class="adjust">
        <button onclick="changeTime(-30)">âˆ’</button>
        <button onclick="changeTime(30)">+</button>
    </div>

    <div class="controls">
        <button onclick="startTimer()">â–¶ Start</button>
        <button onclick="stopTimer()">â¸ Stop</button>
        <button onclick="resetTimer()">ğŸ”„ Reset</button>
    </div>
</div>

<script>
let time = 420;
let defaultTime = 420;
let interval = null;
let soundMode = "normal";

const sound = document.getElementById("alarmSound");

/* Zuordnung Flagge â†’ Hymne */
const countryConfig = {
    bosnia: {
        bg: "flag-bosnia.jpg",
        anthem: "anthem-bosnia.mp3"
    },
    albania: {
        bg: "flag-albania.jpg",
        anthem: "anthem-albania.mp3"
    },
    croatia: {
        bg: "flag-croatia.jpg",
        anthem: "anthem-croati.mp3"
    },
    turkey: {
        bg: "flag-turkey.jpg",
        anthem: "anthem-turkey.mp3"
    }
};

function updateDisplay() {
    const m = String(Math.floor(time / 60)).padStart(2, "0");
    const s = String(time % 60).padStart(2, "0");
    document.getElementById("timer").innerText = `${m}:${s}`;
}

function startTimer() {
    if (interval) return;

    // iOS Audio Unlock
    sound.muted = true;
    sound.play().then(() => {
        sound.pause();
        sound.currentTime = 0;
        sound.muted = false;
    }).catch(()=>{});

    interval = setInterval(() => {
        if (time > 0) {
            time--;
            updateDisplay();
        } else {
            finishTimer();
        }
    }, 1000);
}

function stopTimer() {
    clearInterval(interval);
    interval = null;
}

function resetTimer() {
    stopTimer();
    sound.pause();
    sound.currentTime = 0;
    time = defaultTime;
    updateDisplay();
}

function finishTimer() {
    stopTimer();

    if (soundMode === "normal") {
        sound.play();
    }

    setTimeout(() => {
        alert("â° Ei fertig!");
        resetTimer();
    }, 300);
}

function setPreset(sec) {
    resetTimer();
    time = sec;
    defaultTime = sec;
    updateDisplay();
}

function changeTime(delta) {
    if (interval) return;
    time = Math.max(0, time + delta);
    defaultTime = time;
    updateDisplay();
}

function toggleMenu() {
    const p = document.getElementById("menuPanel");
    p.style.display = p.style.display === "flex" ? "none" : "flex";
}

function setSound(mode) {
    soundMode = mode;
}

function changeBackground(country) {
    const cfg = countryConfig[country];

    document.documentElement.style.setProperty(
        "--bg-image",
        `url("img/${cfg.bg}")`
    );

    sound.pause();
    sound.currentTime = 0;
    sound.src = `img/${cfg.anthem}`;
}

updateDisplay();
changeBackground("bosnia"); // Default
</script>

</body>
</html>
